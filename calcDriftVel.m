function [dVel] = calcDriftVel(Press,driftE,bSF6)
% %calculate Number density
roomT = 296.15;
d = 6.139; %kg/m3 at 1atm at 20C
d = d*((20 + 273.15)/roomT); %Scale to room temp
d = d*(Press / 760);
d = d*1E-3; %convert to g/cm3s
molWg = 146.055; %g/mol
NA = 6.02214129E23; %Avagadro's number
Nd = (d*NA) / molWg;
E_N=driftE*1E17/Nd;

% 
% %Calculate u0
k0_SF6 = [ 0.5424, 0.5485, 0.5469, 0.5482, 0.5493, 0.5517, 0.5558, 0.5610, 0.5673, 0.5736,0.5810, 0.5894 ];
E_N_k0_SF6 = [ 13.1501, 26.3001, 39.4502, 52.6003, 65.7503, 78.9004, 92.0505, 105.2005,118.3506, 131.5007, 144.6507, 157.8008 ]; %Td = 10E-17Vcm2

k0_SF5 = [0.5757321872015282,0.5808194842406876,0.5824821394460362,0.5881669531996179,0.5927148042024832, ...
                0.6018502387774594,0.6109887297039159,0.6195587392550143,0.6292779369627507,0.6395702005730659];
E_N_k0_SF5 = [39.56701916483363,52.480746024977286,65.86681546926313, 79.18932966020313, ...
                91.7628020593469, 105.03482914576011,118.75903682500487,131.82567385564073,144.5439770745928,158.48931924611125];
k0_SF5 = [0.5902542372881355, 0.5898305084745762, 0.5906779661016949, 0.5915254237288134, 0.5923728813559321, 0.5940677966101694, ...
            0.5991525423728813, 0.608050847457627, 0.6203389830508474, 0.6394067796610169, 0.6491525423728812, 0.6627118644067795, ...
            0.6771186440677965, 0.6970338983050847, 0.708050847457627, 0.7203389830508473, 0.7241525423728813, 0.7254237288135592, ...
            0.723728813559322, 0.7190677966101694, 0.7122881355932202, 0.7063559322033898 ];
E_N_k0_SF5 = [31.138921842262885,41.9534670730687, 58.29415347136077, 74.22252322562389, 82.68195069620211, 92.10553176894824, 108.57111194022039, ...
                128.63969449369745, 142.56662123571948, 165.48170999431815, 176.91630371419228, 193.06977288832496, ...
                210.6981460757205, 242.06308919513563, 261.4632855857433, 295.78908427053915, 311.38921842262886,...
                327.81211513934585, 346.8794496070205, 367.05584388948455, 388.40580693395657, 406.7944321083047]; %Td = 10E-17Vcm2

k0 = k0_SF6;
E_N_k0 = E_N_k0_SF6;
if ~bSF6
    k0 = k0_SF5;
    E_N_k0 = E_N_k0_SF5;
end
% fitU0 = fit(E_N_k0',k0','linearinterp');
% u0 = fitU0(E_N)
% %Calculate driftVel
% N_0 = 2.687E19; %cm-3 at STP
% dVel = u0*N_0*(driftE / Nd);
% dVel = dVel/100; %convert to um/us

T_room = 296.15 ;                       %%%% Room temperature at operation time ( 23 C = 296.15 K )

N0 = 2.687E19 ;                         %%%% Number density at STP (0 C = 273.15 K, 1.0 atmosphere)
T_STP = 273.15 ;                        %%%% Temperature at STP in Kelvins
P_STP = 760;                           %%%% Pressure at STP in Torr
%%%% Outputs
N_SF6 = (Press/P_STP)*N0*(T_STP/T_room);
E_N=driftE*1E17/N_SF6;
fitU0 = fit(E_N_k0',k0','linearinterp');
u0 = fitU0(E_N);
dVel = u0*N0*(driftE / N_SF6);
dVel = dVel/100; %convert to um/us

if bSF6
%     dVel = 155.9960; %
    dVel = 156.1; %
else
%     dVel = 169.2224;
    dVel = 168.7;
end
return;
end